import{j as T,k as I,d as j,b as w,r as a,o as B,c as P,w as t,a as e,u as v,g as c,f as L,p as q,q as z,e as V,t as h}from"./index-DEEauFT0.js";import{i as E}from"./DataTable.types-CX4v7_jN.js";import{r as R}from"./ruleUtils-C0l0TtdP.js";const U="http://lnx.simple.auth.test/api/permissions",F=async u=>{try{const r=T();return(await I(r,U).post("/load-data-table",u)).data.data}catch{return E()}},M=async u=>{try{const r=T();return await I(r,U).post("/save",u),!0}catch{return!1}},A=[{title:"Nombre",value:"displayName",key:"permissions.display_name"},{title:"Clave",value:"name",key:"permissions.name"}],H={displayName:[R],type:[R]},J=()=>({id:null,type:"",displayName:null,parentId:null}),D=j({__name:"Form",props:{formState:{type:Object,default:()=>({})}},emits:["onSuccess"],setup(u,{emit:r}){const n=r,S=u,g=H,l=w(null),f=w(!1),p=w(!1),d=w({...J(),...S.formState}),N=async()=>{const{valid:x}=await l.value.validate();if(!x)return;f.value=!0,await M(d.value)&&(d.value.id==null&&l.value.reset(),n("onSuccess"),p.value=!1),f.value=!1};return(x,s)=>{const o=a("v-text-field"),y=a("v-col"),m=a("v-row"),b=a("v-card-item"),i=a("v-btn"),_=a("v-spacer"),C=a("v-card-actions"),$=a("v-card"),O=a("v-form"),G=a("v-dialog");return B(),P(G,{"max-width":"700",modelValue:p.value,"onUpdate:modelValue":s[2]||(s[2]=k=>p.value=k),activator:"parent"},{default:t(()=>[e(O,{ref_key:"formRef",ref:l,onSubmit:L(N,["prevent"])},{default:t(()=>[e($,{title:d.value.id?"Editar Registro":"Nuevo Registro"},{default:t(()=>[e(b,{class:"border-t border-b"},{default:t(()=>[e(m,null,{default:t(()=>[e(y,{cols:"12"},{default:t(()=>[e(o,{modelValue:d.value.displayName,"onUpdate:modelValue":s[0]||(s[0]=k=>d.value.displayName=k),label:"Nombre",rules:v(g).displayName,autocomplete:"off"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1}),e(C,null,{default:t(()=>[e(i,{type:"button",variant:"text",color:"secondary",onClick:s[1]||(s[1]=k=>p.value=!1)},{default:t(()=>s[3]||(s[3]=[c(" Cancelar ")])),_:1}),e(_),e(i,{text:"Guardar",color:"primary",type:"submit",loading:f.value},null,8,["loading"])]),_:1})]),_:1},8,["title"])]),_:1},512)]),_:1},8,["modelValue"])}}}),K={class:"bg-gray"},Q=["colspan"],W={class:"d-flex justify-space-between align-center"},X={class:"text-primary"},te=j({__name:"index",setup(u){return(r,n)=>{const S=a("v-text-field"),g=a("v-col"),l=a("v-btn"),f=a("v-row"),p=a("v-card-item"),d=a("v-icon"),N=a("LnxDataTable"),x=a("v-card"),s=q("tooltip");return B(),P(x,{title:"Permisos",subtitle:"GestiÃ³n de permisos"},{default:t(()=>[e(N,{loadDataTable:v(F),headers:v(A),groupBy:[{key:"parentName"}]},{header:t(({request:o,loading:y,init:m,loadingTable:b,debouncedReload:i,reLoadDataTable:_})=>[e(p,{class:"border-t border-b"},{default:t(()=>[e(f,{class:"d-flex justify-space-between"},{default:t(()=>[e(g,{cols:"12",md:"4"},{default:t(()=>[e(S,{modelValue:o.search,"onUpdate:modelValue":C=>o.search=C,label:"Buscar",clearable:"",onInput:i,"onClick:clear":_},null,8,["modelValue","onUpdate:modelValue","onInput","onClick:clear"])]),_:2},1024),e(g,{cols:"12",md:"4",class:"d-flex justify-end text-end align-center"},{default:t(()=>[e(l,{class:"me-2",disabled:y},{default:t(()=>[n[0]||(n[0]=c(" Registrar modulo ")),e(v(D),{formState:{type:"001"},onOnSuccess:m},null,8,["onOnSuccess"])]),_:2},1032,["disabled"]),z(e(l,{density:"comfortable",icon:"mdi-reload",onClick:m,loading:b},null,8,["onClick","loading"]),[[s,"Recargar registros","top"]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),"group-header":t(({item:o,columns:y,toggleGroup:m,isGroupOpen:b})=>[V("tr",K,[V("td",{colspan:y.length,class:"bg-grey-lighten-4"},[V("div",W,[V("div",X,[e(l,{"prepend-icon":b(o)?"$expand":"$next",size:"small",variant:"plain",onClick:i=>m(o)},{default:t(()=>[c(h(o.value),1)]),_:2},1032,["prepend-icon","onClick"])]),e(l,{"prepend-icon":"mdi-plus",density:"compact",variant:"tonal"},{default:t(()=>{var i,_;return[n[1]||(n[1]=c(" Permiso ")),e(v(D),{formState:{type:"002",parentId:(_=(i=o==null?void 0:o.items[0])==null?void 0:i.raw)==null?void 0:_.parentId}},null,8,["formState"])]}),_:2},1024)])],8,Q)])]),"item.actions":t(({item:o})=>[c(h(o.id),1)]),"item.permissions":t(({item:o})=>[e(l,{rounded:"sm",variant:"tonal",class:"me-1",density:"comfortable","prepend-icon":"mdi-eye"},{default:t(()=>n[2]||(n[2]=[c(" Permisos ")])),_:1}),e(l,{rounded:"sm",variant:"tonal",class:"",density:"compact",icon:""},{default:t(()=>[e(d,null,{default:t(()=>n[3]||(n[3]=[c("mdi-plus")])),_:1}),e(v(D),{formState:{parentId:o.id,type:"002"}},null,8,["formState"])]),_:2},1024)]),_:1},8,["loadDataTable","headers"])]),_:1})}}});export{te as default};
