import{d as D,b as m,C as N,r as a,o as v,c as _,w as s,a as o,q as O,A as f,g as b,_ as S,f as q}from"./index-CVCjnSgw.js";import{d as F,e as L}from"./sacrament-records.services-BZrvOhck.js";const T=["src"],M=D({__name:"PrintAct",props:{record:{}},emits:["onSuccess"],setup(g,{emit:w}){const x=w,y=g,t=m(null),c=m(!1),d=m(!1),V=async()=>{},C=async()=>{c.value=!0;const r=await L(y.record);t.value=r,c.value=!1},k=async()=>{c.value=!0;let r=await F(t.value.data),e=URL.createObjectURL(r);const l=document.getElementById("printFrame");l.src=e,l.onload=function(){l.contentWindow&&(l.contentWindow.print(),d.value=!1,x("onSuccess"))},c.value=!1},P=async()=>{await C()};return N(()=>d.value,r=>{r&&P()}),(r,e)=>{const l=a("v-textarea"),R=a("v-card-text"),p=a("v-btn"),A=a("v-spacer"),B=a("v-card-actions"),E=a("v-card"),I=a("v-form"),U=a("v-dialog");return v(),_(U,{"max-width":"600",modelValue:d.value,"onUpdate:modelValue":e[2]||(e[2]=n=>d.value=n),activator:"parent",persistent:"",scrollable:""},{default:s(()=>[o(I,{ref:"formRef",onSubmit:q(V,["prevent"])},{default:s(()=>[o(E,{title:"Imprimir Acta"},{default:s(()=>[o(R,{class:"pa-0"},{default:s(()=>{var n,u;return[t.value?(v(),O("iframe",{key:0,src:(n=t.value)==null?void 0:n.urlTemp,width:"100%",height:"500",frameborder:"0"},null,8,T)):f("",!0),(u=t.value)!=null&&u.existPrintings?(v(),_(l,{key:1,class:"pa-3",label:"Observaciones de la reimpresión",rows:"2",modelValue:t.value.data.observations,"onUpdate:modelValue":e[0]||(e[0]=i=>t.value.data.observations=i),rules:[i=>!!i||"Este campo es requerido"]},null,8,["modelValue","rules"])):f("",!0)]}),_:1}),o(B,null,{default:s(()=>{var n,u,i;return[o(p,{type:"button",variant:"text",color:"secondary",onClick:e[1]||(e[1]=W=>d.value=!1)},{default:s(()=>e[3]||(e[3]=[b(" Cancelar ")])),_:1}),o(A),o(p,{color:"primary",type:"submit",loading:c.value,disabled:((n=t.value)==null?void 0:n.existPrintings)&&(((u=t.value)==null?void 0:u.data.observations)==null||((i=t.value)==null?void 0:i.data.observations)=="")},{default:s(()=>[o(S,{onOnConfirm:k,title:"Imprimir Acta",message:"¿Estás seguro de imprimir el acta?"}),e[4]||(e[4]=b(" Imprimir "))]),_:1},8,["loading","disabled"])]}),_:1})]),_:1})]),_:1},512)]),_:1},8,["modelValue"])}}});export{M as _};
