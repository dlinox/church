import{j as B,k as R,d as j,b as w,r as o,o as E,c as I,w as t,a as e,u as s,g as b,f as z,p as M,q as A,t as $}from"./index-DEEauFT0.js";import{i as G}from"./DataTable.types-CX4v7_jN.js";import{r as x}from"./ruleUtils-C0l0TtdP.js";const h="http://lnx.simple.auth.test/api/sacramental-books",H=async c=>{try{const i=B();return(await R(i,h).post("/load-data-table",c)).data.data}catch{return G()}},J=async c=>{try{const i=B();return await R(i,h).post("/save",c),!0}catch{return!1}},K=async c=>{try{const i=B();return await R(i,h).delete(`/delete/${c}`),!0}catch{return!1}},Q=[{title:"Op.",key:"actions",value:"actions",fixed:!0,width:"50px",sortable:!1},{title:"Sacramento",key:"sacrament_type",value:"sacramentType.title"},{title:"Libro",key:"number",value:"number"},{title:"Núm. de Folios",key:"foliosNumber",value:"foliosNumber"},{title:"Fecha de Creación",key:"yearStart",value:"yearStart"},{title:"Fecha de Cierre",key:"yearFinish",value:"yearFinish"},{title:"Estado",key:"status",value:"status",sortable:!1}],P=[{value:"1",title:"Bautismo"},{value:"2",title:"Confirmación"},{value:"4",title:"Matrimonio"}],W={number:[x],foliosNumber:[x],yearStart:[x],yearFinish:[],actsPerFolio:[x],sacramentType:[x]},X=()=>({number:0,foliosNumber:0,actsPerFolio:3,yearStart:null,yearFinish:null,sacramentType:{value:"1",title:"Bautismo"}}),L=j({__name:"Form",props:{formState:{type:Object,default:()=>({})}},emits:["onSuccess"],setup(c,{emit:i}){const u=i,C=c,d=W,y=w(null),f=w(!1),_=w(!1),a=w({...X(),...C.formState}),V=async()=>{const{valid:k}=await y.value.validate();if(!k)return;f.value=!0,await J(a.value)&&(a.value.id==null&&y.value.reset(),u("onSuccess"),_.value=!1),f.value=!1};return(k,l)=>{const S=o("v-select"),m=o("v-col"),p=o("v-text-field"),N=o("v-row"),T=o("v-card-item"),g=o("v-btn"),r=o("v-spacer"),v=o("v-card-actions"),F=o("v-card"),U=o("v-form"),D=o("v-dialog");return E(),I(D,{"max-width":"500",modelValue:_.value,"onUpdate:modelValue":l[7]||(l[7]=n=>_.value=n),activator:"parent"},{default:t(()=>[e(U,{ref_key:"formRef",ref:y,onSubmit:z(V,["prevent"])},{default:t(()=>[e(F,{title:a.value.id?"Editar Registro":"Nuevo Registro"},{default:t(()=>[e(T,{class:"border-t border-b"},{default:t(()=>[e(N,null,{default:t(()=>[e(m,{cols:"12"},{default:t(()=>[e(S,{label:"Sacramento",modelValue:a.value.sacramentType,"onUpdate:modelValue":l[0]||(l[0]=n=>a.value.sacramentType=n),items:s(P),rules:s(d).sacramentType,autocomplete:"off","return-object":""},null,8,["modelValue","items","rules"])]),_:1}),e(m,{cols:"12"},{default:t(()=>[e(p,{modelValue:a.value.number,"onUpdate:modelValue":l[1]||(l[1]=n=>a.value.number=n),modelModifiers:{number:!0},label:"Número de libro",rules:s(d).number,autocomplete:"off"},null,8,["modelValue","rules"])]),_:1}),e(m,{cols:"6"},{default:t(()=>[e(p,{label:"Número de folios",modelValue:a.value.foliosNumber,"onUpdate:modelValue":l[2]||(l[2]=n=>a.value.foliosNumber=n),modelModifiers:{number:!0},rules:s(d).foliosNumber,autocomplete:"off"},null,8,["modelValue","rules"])]),_:1}),e(m,{cols:"6"},{default:t(()=>[e(S,{label:"Número de actas por folio",modelValue:a.value.actsPerFolio,"onUpdate:modelValue":l[3]||(l[3]=n=>a.value.actsPerFolio=n),items:[1,2,3,4,5],rules:s(d).actsPerFolio,autocomplete:"off"},null,8,["modelValue","rules"])]),_:1}),e(m,{cols:"6"},{default:t(()=>[e(p,{label:"Año de inicio",modelValue:a.value.yearStart,"onUpdate:modelValue":l[4]||(l[4]=n=>a.value.yearStart=n),rules:s(d).yearStart,autocomplete:"off"},null,8,["modelValue","rules"])]),_:1}),e(m,{cols:"6"},{default:t(()=>[e(p,{label:"Año de fin",modelValue:a.value.yearFinish,"onUpdate:modelValue":l[5]||(l[5]=n=>a.value.yearFinish=n),rules:s(d).yearFinish,autocomplete:"off"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1}),e(v,null,{default:t(()=>[e(g,{type:"button",variant:"text",color:"secondary",onClick:l[6]||(l[6]=n=>_.value=!1)},{default:t(()=>l[8]||(l[8]=[b(" Cancelar ")])),_:1}),e(r),e(g,{text:"Guardar",color:"primary",type:"submit",loading:f.value},null,8,["loading"])]),_:1})]),_:1},8,["title"])]),_:1},512)]),_:1},8,["modelValue"])}}}),ee=j({__name:"index",setup(c){return(i,u)=>{const C=o("v-text-field"),d=o("v-col"),y=o("v-select"),f=o("v-btn"),_=o("v-row"),a=o("v-card-item"),V=o("v-icon"),k=o("v-list-item"),l=o("LnxDialogConfirm"),S=o("v-list"),m=o("v-menu"),p=o("v-chip"),N=o("LnxDataTable"),T=o("v-card"),g=M("tooltip");return E(),I(T,{title:"Libros",subtitle:"Listado de libros"},{default:t(()=>[e(N,{loadDataTable:s(H),headers:s(Q)},{header:t(({request:r,loading:v,init:F,loadingTable:U,debouncedReload:D,reLoadDataTable:n})=>[e(a,{class:"border-t border-b"},{default:t(()=>[e(_,{class:"d-flex justify-space-between align-center"},{default:t(()=>[e(d,{cols:"12",md:"4"},{default:t(()=>[e(C,{modelValue:r.search,"onUpdate:modelValue":O=>r.search=O,label:"Buscar",clearable:"",onInput:D,"onClick:clear":n},null,8,["modelValue","onUpdate:modelValue","onInput","onClick:clear"])]),_:2},1024),e(d,{cols:"12",md:"4"},{default:t(()=>[e(y,{modelValue:r.filters.sacrament_type,"onUpdate:modelValue":[O=>r.filters.sacrament_type=O,n],label:"Sacramento",items:s(P),clearable:""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),e(d,{cols:"12",md:"4",class:"d-md-flex d-block justify-end text-end"},{default:t(()=>[e(f,{class:"me-2",disabled:v},{default:t(()=>[u[0]||(u[0]=b(" nuevo ")),e(s(L),{onOnSuccess:F},null,8,["onOnSuccess"])]),_:2},1032,["disabled"]),A(e(f,{density:"comfortable",icon:"mdi-reload",onClick:F,loading:U},null,8,["onClick","loading"]),[[g,"Recargar registros"]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),"item.actions":t(({item:r,loadDataTable:v})=>[e(f,{icon:"",size:"small",variant:"text"},{default:t(()=>[e(V,null,{default:t(()=>u[1]||(u[1]=[b(" mdi-dots-vertical ")])),_:1}),e(m,{activator:"parent"},{default:t(()=>[e(S,{nav:""},{default:t(()=>[e(k,{title:"Editar",density:"compact",value:"edit"},{prepend:t(()=>[e(V,{size:"small"},{default:t(()=>u[2]||(u[2]=[b(" mdi-pencil ")])),_:1})]),default:t(()=>[e(s(L),{formState:r,onOnSuccess:v},null,8,["formState","onOnSuccess"])]),_:2},1024),e(k,{title:"Eliminar",class:"text-red",density:"compact",value:"delete"},{prepend:t(()=>[e(V,{size:"small"},{default:t(()=>u[3]||(u[3]=[b(" mdi-delete ")])),_:1})]),default:t(()=>[e(l,{onOnConfirm:async()=>{await s(K)(r.id),v()},message:"¿Está seguro de eliminar este registro?"},null,8,["onOnConfirm"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),"item.status":t(({item:r})=>[e(p,{color:r.yearFinish===null?"info":"dark"},{default:t(()=>[b($(r.yearFinish===null?"Activo":"Finalizado"),1)]),_:2},1032,["color"])]),_:1},8,["loadDataTable","headers"])]),_:1})}}});export{ee as default};
