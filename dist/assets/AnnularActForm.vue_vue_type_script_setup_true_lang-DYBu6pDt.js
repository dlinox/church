import{_ as z,c as J,d as G,e as M}from"./Form.vue_vue_type_script_setup_true_lang-DrqE6RAm.js";import{d as L,b as y,r as a,o as _,c as b,w as t,a as o,g as c,u as F,e as H,q as K,v as Q,F as W,x as j,D as q,h as X,t as x,A as R,i as T,_ as Y,f as Z}from"./index-Cg9yRFqc.js";import{b as h}from"./selectItems.services-WlXGXuBa.js";import{j as ee}from"./sacrament-records.services-DJmQUm0N.js";import{r as te}from"./ruleUtils-Dk9EfJu0.js";const oe=L({__name:"BoxSearchPerson",emits:["onSelect"],setup(S,{emit:f}){const p=f,s=y(!1),l=y(!1),u=y(""),i=y([]),d=j(async n=>{if(n==null){i.value=[];return}if(n.length<3)return;l.value=!0;let e=await J(n);i.value=e,l.value=!1},300),g=n=>{console.log(n),p("onSelect",n),s.value=!1,u.value="",i.value=[]};return(n,e)=>{const m=a("v-icon"),v=a("v-btn"),C=a("v-text-field"),N=a("v-card-title"),I=a("v-alert"),w=a("v-card-item"),$=a("v-list-item-subtitle"),P=a("v-list-item"),V=a("v-list"),k=a("v-card"),O=a("v-dialog");return _(),b(O,{"max-width":"600",modelValue:s.value,"onUpdate:modelValue":e[4]||(e[4]=r=>s.value=r),activator:"parent"},{default:t(()=>[o(k,{title:"Buscar persona"},{append:t(()=>[o(v,{icon:"",onClick:e[0]||(e[0]=r=>s.value=!1),density:"compact",variant:"tonal",color:"muted"},{default:t(()=>[o(m,null,{default:t(()=>e[5]||(e[5]=[c("mdi-close")])),_:1})]),_:1})]),default:t(()=>[o(k,{variant:"tonal",subtitle:"Resultados de la búsqueda",loading:l.value},{default:t(()=>[o(N,null,{default:t(()=>[o(C,{label:"Buscar",clearable:"","onUpdate:modelValue":[F(d),e[1]||(e[1]=r=>u.value=r)],modelValue:u.value},null,8,["onUpdate:modelValue","modelValue"])]),_:1}),i.value.length==0?(_(),b(w,{key:0},{default:t(()=>[o(I,{dense:"",outlined:"",class:"text-center"},{default:t(()=>[e[7]||(e[7]=H("small",{class:"text-secondary d-block"}," No se encontraron resultados, escribe al menos 3 caracteres ",-1)),o(v,{"prepend-icon":"mdi-plus",class:"mt-2"},{default:t(()=>[o(z,{onOnSuccess:e[2]||(e[2]=r=>F(d)(r.documentNumber))}),e[6]||(e[6]=c(" Nueva "))]),_:1})]),_:1})]),_:1})):(_(),b(V,{key:1,dense:"",class:"border-t overflow-y-auto",style:{"max-height":"200px"}},{default:t(()=>[(_(!0),K(W,null,Q(i.value,r=>(_(),b(P,{class:"border-b",color:"primary",key:r.id,title:`${r.documentNumber??""}  ${r.fullName}`},{prepend:t(()=>[o(m,{size:"small"},{default:t(()=>e[8]||(e[8]=[c("mdi-account")])),_:1})]),default:t(()=>[o($,{class:"text-end"},{default:t(()=>[o(v,{density:"compact",color:"info",variant:"text"},{default:t(()=>[o(z,{formState:r,onOnSuccess:e[3]||(e[3]=B=>F(d)(B.documentNumber))},null,8,["formState"]),e[9]||(e[9]=c(" editar "))]),_:2},1024),o(v,{density:"compact",color:"primary",variant:"text",class:"ms-2",onClick:B=>g(r)},{default:t(()=>e[10]||(e[10]=[c(" seleccionar ")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["title"]))),128))]),_:1}))]),_:1},8,["loading"])]),_:1})]),_:1},8,["modelValue"])}}}),ie=L({__name:"PersonField",props:{title:{},modelValue:{},family:{type:Boolean}},emits:["modelValue","onFamily","onRemove","onSelected"],setup(S,{emit:f}){const p=f,s=S,l=y(null),u=q({get:()=>(console.log(s.title,":",s.modelValue),s.modelValue.personId?(i(s.modelValue.personId),p("onSelected",s.modelValue.personId)):l.value=null,s.modelValue),set:n=>p("modelValue",n)}),i=async n=>{let e=await G(n);l.value=e},d=()=>{u.value.personId=null,s.family&&u.value.family.map(n=>{n.personId=null}),p("modelValue",u.value)},g=async n=>{if(l.value=n,u.value.personId=n.id,s.family){let e=await M(n.id);u.value.family.map(m=>{e.map(v=>{v.role==m.role&&(m.personId=v.personId)}),e.length==0&&(m.personId=null)})}p("modelValue",{personId:n.id})};return(n,e)=>{const m=a("v-btn"),v=a("v-icon"),C=a("v-card-text"),N=a("v-card-item"),I=a("v-list-item-title"),w=a("v-list-item-subtitle"),$=a("v-list-item"),P=a("v-spacer"),V=a("v-card-actions"),k=a("v-card"),O=X("tooltip");return _(),b(k,{"data-value":u.value.personId,rounded:"0",elevation:"0",class:"border"},{default:t(()=>[o(m,{rounded:"0",variant:"text","prepend-icon":l.value?"mdi-account-edit":"mdi-account-search",block:"",class:"text-start justify-start"},{default:t(()=>[o(oe,{onOnSelect:g}),c(" "+x(n.title?n.title:"Persona"),1)]),_:1},8,["prepend-icon"]),l.value?R("",!0):(_(),b(N,{key:0,class:"text-center"},{default:t(()=>[o(v,{size:"large",class:"text-secondary"},{default:t(()=>e[2]||(e[2]=[c(" mdi-account-search ")])),_:1}),o(C,{class:"text-secondary"},{default:t(()=>e[3]||(e[3]=[c(" Seleccione una persona ")])),_:1})]),_:1})),l.value?(_(),b($,{key:1},{default:t(()=>[o(I,null,{default:t(()=>{var r,B,U,A,D,E;return[c(x((B=(r=l.value)==null?void 0:r.documentType)==null?void 0:B.title)+" - "+x((U=l.value)==null?void 0:U.documentNumber)+" | "+x((A=l.value)==null?void 0:A.name)+" "+x((D=l.value)==null?void 0:D.paternalLastName)+" "+x((E=l.value)==null?void 0:E.maternalLastName),1)]}),_:1}),o(w,{class:"my-2"},{default:t(()=>{var r;return[o(v,{size:"small"},{default:t(()=>e[4]||(e[4]=[c(" mdi-calendar ")])),_:1}),c(" "+x((r=l.value)==null?void 0:r.birthDate),1)]}),_:1}),o(w,{class:"my-2"},{default:t(()=>{var r,B,U,A,D;return[o(v,{size:"small"},{default:t(()=>e[5]||(e[5]=[c(" mdi-map-marker ")])),_:1}),c(" "+x((B=(r=l.value)==null?void 0:r.birthCountry)==null?void 0:B.title)+" - "+x((A=(U=l.value)==null?void 0:U.birthLocation)==null?void 0:A.title)+", "+x((D=l.value)==null?void 0:D.birthLocationDetail),1)]}),_:1})]),_:1})):R("",!0),l.value?(_(),b(V,{key:2,class:"py-1"},{default:t(()=>[o(P),T((_(),b(m,{density:"comfortable",variant:"tonal","prepend-icon":"mdi-account-edit",color:"info"},{default:t(()=>[o(z,{formState:l.value,onOnSuccess:e[0]||(e[0]=r=>i(l.value.id))},null,8,["formState"]),e[6]||(e[6]=c(" Editar "))]),_:1})),[[O,"Remover"]]),T(o(m,{density:"compact",variant:"tonal",icon:"mdi-delete",color:"error",onClick:e[1]||(e[1]=r=>d())},null,512),[[O,"Remover"]])]),_:1})):R("",!0)]),_:1},8,["data-value"])}}}),ae=L({__name:"LnxAutocompleteServer",props:{modelValue:{},service:{type:Function},minChars:{}},emits:["update:modelValue"],setup(S,{emit:f}){const p=f,s=S,l=y([]),u=q({get:()=>s.modelValue,set:d=>p("update:modelValue",d)}),i=j(async d=>{d=d.trim();const g=s.minChars||3;if(d.length<g)return;let n=await s.service(d);l.value=n},350);return(d,g)=>{const n=a("v-autocomplete");return _(),b(n,{modelValue:u.value,"onUpdate:modelValue":g[0]||(g[0]=e=>u.value=e),items:l.value,noDataText:"No se encontraron resultados, escribe al menos 3 caracteres","onUpdate:search":F(i),"return-object":"",clearable:""},null,8,["modelValue","items","onUpdate:search"])}}}),de=L({__name:"DefineParameters",props:{type:{}},setup(S){const f=y(!1),p=y(!1),s=S,l=y({defaultBook:null}),u=async n=>await h(s.type,n),i={1:"baptismParameters",2:"confirmationParameters",4:"marriageParameters"},d=async()=>{p.value=!0;let n={defaultBook:l.value.defaultBook};const e=i[s.type];localStorage.setItem(e,JSON.stringify(n)),p.value=!1,f.value=!1};return(()=>{const n=i[s.type];let e=localStorage.getItem(n);if(e){let m=JSON.parse(e);l.value.defaultBook=m.defaultBook}})(),(n,e)=>{const m=a("v-alert"),v=a("v-col"),C=a("v-row"),N=a("v-card-item"),I=a("v-btn"),w=a("v-spacer"),$=a("v-card-actions"),P=a("v-card"),V=a("v-dialog");return _(),b(V,{"max-width":"400",modelValue:f.value,"onUpdate:modelValue":e[2]||(e[2]=k=>f.value=k),activator:"parent"},{default:t(()=>[o(P,{title:"Definir parámetros"},{default:t(()=>[o(m,{density:"compact",variant:"tonal",color:"info",icon:"mdi-information",class:"text-subtitle-2"},{default:t(()=>e[3]||(e[3]=[c(" Estos valores se guardarán en tu navegador y se usarán como predeterminados al crear un acta. ")])),_:1}),o(N,{class:"border-t border-b"},{default:t(()=>[o(C,null,{default:t(()=>[o(v,{cols:"12"},{default:t(()=>[o(ae,{modelValue:l.value.defaultBook,"onUpdate:modelValue":e[0]||(e[0]=k=>l.value.defaultBook=k),service:u,label:"Libro predeterminado",autocomplete:"off",minChars:1},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),o($,null,{default:t(()=>[o(I,{type:"button",variant:"text",color:"secondary",onClick:e[1]||(e[1]=k=>f.value=!1)},{default:t(()=>e[4]||(e[4]=[c(" Cancelar ")])),_:1}),o(w),o(I,{text:"Guardar",color:"primary",type:"button",onClick:d,loading:p.value},null,8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),ce=L({__name:"AnnularActForm",props:{record:{}},emits:["onSuccess"],setup(S,{emit:f}){const p=f,s=S,l=y({id:s.record.id,observation:s.record.observation}),u=y(!1),i=y(!1),d=async()=>{u.value=!0,await ee(l.value)&&(p("onSuccess"),i.value=!1),u.value=!1};return(async()=>{})(),(n,e)=>{const m=a("v-textarea"),v=a("v-card-item"),C=a("v-btn"),N=a("v-spacer"),I=a("v-card-actions"),w=a("v-card"),$=a("v-form"),P=a("v-dialog");return _(),b(P,{"max-width":"500",modelValue:i.value,"onUpdate:modelValue":e[2]||(e[2]=V=>i.value=V),activator:"parent",persistent:""},{default:t(()=>[o($,{ref:"formRef",onSubmit:Z(d,["prevent"])},{default:t(()=>[o(w,{title:"Anular Acta"},{default:t(()=>[o(v,{class:"pa-0 border-t border-b"},{default:t(()=>[o(m,{modelValue:l.value.observation,"onUpdate:modelValue":e[0]||(e[0]=V=>l.value.observation=V),class:"pa-3",label:"Razón de anulación",rows:"2",rules:[F(te)]},null,8,["modelValue","rules"])]),_:1}),o(I,null,{default:t(()=>[o(C,{type:"button",variant:"text",color:"secondary",onClick:e[1]||(e[1]=V=>i.value=!1)},{default:t(()=>e[3]||(e[3]=[c(" Cancelar ")])),_:1}),o(N),o(C,{disabled:!l.value.observation,color:"error",type:"button",loading:u.value},{default:t(()=>[o(Y,{onOnConfirm:d,title:"Anular Acta",message:"¿Estás seguro de anular el acta?"}),e[4]||(e[4]=c(" Anular "))]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},512)]),_:1},8,["modelValue"])}}});export{ie as _,ae as a,de as b,ce as c};
