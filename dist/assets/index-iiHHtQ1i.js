import{_ as M,a as A,b as $}from"./index-BFCfPAmL.js";import{d as j,b as w,r as l,o as p,c as b,w as t,a as e,u as s,g as y,f as h,h as I,i as g,t as G}from"./index-DkPFh2QW.js";import{r as k}from"./ruleUtils-Dk9EfJu0.js";import"./DataTable.types-CX4v7_jN.js";const H=[{title:"Op.",key:"actions",value:"actions",fixed:!0,width:"50px",sortable:!1},{title:"Sacramento",key:"sacrament_type",value:"sacramentType.title"},{title:"Libro",key:"number",value:"number"},{title:"Núm. de Folios",key:"foliosNumber",value:"foliosNumber"},{title:"Fecha de Creación",key:"yearStart",value:"yearStart"},{title:"Fecha de Cierre",key:"yearFinish",value:"yearFinish"},{title:"Estado",key:"status",value:"status",sortable:!1}],z=[{value:"1",title:"Bautismo"},{value:"2",title:"Confirmación"},{value:"4",title:"Matrimonio"}],J={number:[k],foliosNumber:[k],yearStart:[k],yearFinish:[],actsPerFolio:[k],sacramentType:[k]},K=()=>({number:0,foliosNumber:0,actsPerFolio:3,yearStart:null,yearFinish:null,sacramentType:{value:"1",title:"Bautismo"}}),P=j({__name:"Form",props:{formState:{type:Object,default:()=>({})}},emits:["onSuccess"],setup(L,{emit:R}){const i=R,N=L,u=J,V=w(null),d=w(!1),_=w(!1),a=w({...K(),...N.formState}),x=async()=>{const{valid:S}=await V.value.validate();if(!S)return;d.value=!0,await M(a.value)&&(a.value.id==null&&V.value.reset(),i("onSuccess"),_.value=!1),d.value=!1};return(S,o)=>{const F=l("v-select"),m=l("v-col"),f=l("v-text-field"),U=l("v-row"),T=l("v-card-item"),c=l("v-btn"),D=l("v-spacer"),r=l("v-card-actions"),v=l("v-card"),C=l("v-form"),O=l("v-dialog");return p(),b(O,{"max-width":"500",modelValue:_.value,"onUpdate:modelValue":o[7]||(o[7]=n=>_.value=n),activator:"parent"},{default:t(()=>[e(C,{ref_key:"formRef",ref:V,onSubmit:h(x,["prevent"])},{default:t(()=>[e(v,{title:a.value.id?"Editar Registro":"Nuevo Registro"},{default:t(()=>[e(T,{class:"border-t border-b"},{default:t(()=>[e(U,null,{default:t(()=>[e(m,{cols:"12"},{default:t(()=>[e(F,{label:"Sacramento",modelValue:a.value.sacramentType,"onUpdate:modelValue":o[0]||(o[0]=n=>a.value.sacramentType=n),items:s(z),rules:s(u).sacramentType,autocomplete:"off","return-object":""},null,8,["modelValue","items","rules"])]),_:1}),e(m,{cols:"12"},{default:t(()=>[e(f,{modelValue:a.value.number,"onUpdate:modelValue":o[1]||(o[1]=n=>a.value.number=n),modelModifiers:{number:!0},label:"Número de libro",rules:s(u).number,autocomplete:"off"},null,8,["modelValue","rules"])]),_:1}),e(m,{cols:"6"},{default:t(()=>[e(f,{label:"Número de folios",modelValue:a.value.foliosNumber,"onUpdate:modelValue":o[2]||(o[2]=n=>a.value.foliosNumber=n),modelModifiers:{number:!0},rules:s(u).foliosNumber,autocomplete:"off"},null,8,["modelValue","rules"])]),_:1}),e(m,{cols:"6"},{default:t(()=>[e(F,{label:"Número de actas por folio",modelValue:a.value.actsPerFolio,"onUpdate:modelValue":o[3]||(o[3]=n=>a.value.actsPerFolio=n),items:[1,2,3,4,5],rules:s(u).actsPerFolio,autocomplete:"off"},null,8,["modelValue","rules"])]),_:1}),e(m,{cols:"6"},{default:t(()=>[e(f,{label:"Año de inicio",modelValue:a.value.yearStart,"onUpdate:modelValue":o[4]||(o[4]=n=>a.value.yearStart=n),rules:s(u).yearStart,autocomplete:"off"},null,8,["modelValue","rules"])]),_:1}),e(m,{cols:"6"},{default:t(()=>[e(f,{label:"Año de fin",modelValue:a.value.yearFinish,"onUpdate:modelValue":o[5]||(o[5]=n=>a.value.yearFinish=n),rules:s(u).yearFinish,autocomplete:"off"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1}),e(r,null,{default:t(()=>[e(c,{type:"button",variant:"text",color:"secondary",onClick:o[6]||(o[6]=n=>_.value=!1)},{default:t(()=>o[8]||(o[8]=[y(" Cancelar ")])),_:1}),e(D),e(c,{text:"Guardar",color:"primary",type:"submit",loading:d.value},null,8,["loading"])]),_:1})]),_:1},8,["title"])]),_:1},512)]),_:1},8,["modelValue"])}}}),Z=j({__name:"index",setup(L){return(R,i)=>{const N=l("v-text-field"),u=l("v-col"),V=l("v-select"),d=l("v-btn"),_=l("v-row"),a=l("v-card-item"),x=l("v-icon"),S=l("v-list-item"),o=l("LnxDialogConfirm"),F=l("v-list"),m=l("v-menu"),f=l("v-chip"),U=l("LnxDataTable"),T=l("v-card"),c=I("permission"),D=I("tooltip");return p(),b(T,{title:"Libros",subtitle:"Listado de libros"},{default:t(()=>[e(U,{loadDataTable:s($),headers:s(H)},{header:t(({request:r,loading:v,init:C,loadingTable:O,debouncedReload:n,reLoadDataTable:E})=>[e(a,{class:"border-t border-b"},{default:t(()=>[e(_,{class:"d-flex justify-space-between align-center"},{default:t(()=>[e(u,{cols:"12",md:"4"},{default:t(()=>[e(N,{modelValue:r.search,"onUpdate:modelValue":B=>r.search=B,label:"Buscar",clearable:"",onInput:n,"onClick:clear":E},null,8,["modelValue","onUpdate:modelValue","onInput","onClick:clear"])]),_:2},1024),e(u,{cols:"12",md:"4"},{default:t(()=>[e(V,{modelValue:r.filters.sacrament_type,"onUpdate:modelValue":[B=>r.filters.sacrament_type=B,E],label:"Sacramento",items:s(z),clearable:""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),e(u,{cols:"12",md:"4",class:"d-md-flex d-block justify-end text-end"},{default:t(()=>[g((p(),b(d,{class:"me-2",disabled:v},{default:t(()=>[i[0]||(i[0]=y(" nuevo ")),e(s(P),{onOnSuccess:C},null,8,["onOnSuccess"])]),_:2},1032,["disabled"])),[[c,["crear_libro"]]]),g(e(d,{density:"comfortable",icon:"mdi-reload",onClick:C,loading:O},null,8,["onClick","loading"]),[[D,"Recargar registros"]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),"item.actions":t(({item:r,loadDataTable:v})=>[g((p(),b(d,{icon:"",size:"small",variant:"text"},{default:t(()=>[e(x,null,{default:t(()=>i[1]||(i[1]=[y(" mdi-dots-vertical ")])),_:1}),e(m,{activator:"parent"},{default:t(()=>[e(F,{nav:""},{default:t(()=>[g((p(),b(S,{title:"Editar",density:"compact",value:"edit"},{prepend:t(()=>[e(x,{size:"small"},{default:t(()=>i[2]||(i[2]=[y(" mdi-pencil ")])),_:1})]),default:t(()=>[e(s(P),{formState:r,onOnSuccess:v},null,8,["formState","onOnSuccess"])]),_:2},1024)),[[c,["editar_libro","eliminar_libro"]]]),g((p(),b(S,{title:"Eliminar",class:"text-red",density:"compact",value:"delete"},{prepend:t(()=>[e(x,{size:"small"},{default:t(()=>i[3]||(i[3]=[y(" mdi-delete ")])),_:1})]),default:t(()=>[e(o,{onOnConfirm:async()=>{await s(A)(r.id),v()},message:"¿Está seguro de eliminar este registro?"},null,8,["onOnConfirm"])]),_:2},1024)),[[c,["eliminar_libro"]]])]),_:2},1024)]),_:2},1024)]),_:2},1024)),[[c,["editar_libro","eliminar_libro"]]])]),"item.status":t(({item:r})=>[e(f,{color:r.yearFinish===null?"info":"dark"},{default:t(()=>[y(G(r.yearFinish===null?"Activo":"Finalizado"),1)]),_:2},1032,["color"])]),_:1},8,["loadDataTable","headers"])]),_:1})}}});export{Z as default};
