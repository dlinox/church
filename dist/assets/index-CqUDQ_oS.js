import{n as B,p as C,d as P,e as v,r as o,o as b,c as g,w as t,a as e,u as w,g as U,f as G,h as $,i as y,t as H}from"./index-COlo1_dD.js";import{i as F,_ as L}from"./DialogConfirm.vue_vue_type_script_setup_true_lang-DPyE17II.js";import{r as M}from"./ruleUtils-DaB-ACZt.js";const E="https://church-api.linox.net.pe/api/offices",z=async m=>{try{const l=B();return(await C(l,E).post("/load-data-table",m)).data.data}catch{return F()}},A=async m=>{try{const l=B();return await C(l,E).post("/save",m),!0}catch{return!1}},J=async m=>{try{const l=B();return await C(l,E).delete(`/delete/${m}`),!0}catch{return!1}},R={name:[M],description:[]},K=()=>({id:null,name:"",description:null,status:!0}),N=P({__name:"Form",props:{formState:{type:Object,default:()=>({})}},emits:["onSuccess"],setup(m,{emit:l}){const d=l,r=m,a=v(!1),u=v(!1),i=v({...K(),...r.formState}),x=async()=>{a.value=!0,await A(i.value)&&(d("onSuccess"),u.value=!1),a.value=!1};return(f,n)=>{const V=o("v-text-field"),c=o("v-col"),s=o("v-textarea"),k=o("v-switch"),T=o("v-row"),D=o("v-card-item"),_=o("v-btn"),S=o("v-spacer"),O=o("v-card-actions"),I=o("v-card"),j=o("v-form"),q=o("v-dialog");return b(),g(q,{"max-width":"700",modelValue:u.value,"onUpdate:modelValue":n[4]||(n[4]=p=>u.value=p),activator:"parent"},{default:t(()=>[e(j,{ref:"formRef",onSubmit:G(x,["prevent"])},{default:t(()=>[e(I,{title:i.value.id?"Editar Registro":"Nuevo Registro"},{default:t(()=>[e(D,{class:"border-t border-b"},{default:t(()=>[e(T,null,{default:t(()=>[e(c,{cols:"12"},{default:t(()=>[e(V,{modelValue:i.value.name,"onUpdate:modelValue":n[0]||(n[0]=p=>i.value.name=p),label:"Nombre",rules:w(R).name},null,8,["modelValue","rules"])]),_:1}),e(c,{cols:"12"},{default:t(()=>[e(s,{modelValue:i.value.description,"onUpdate:modelValue":n[1]||(n[1]=p=>i.value.description=p),label:"Descripción",rules:w(R).description,rows:"2"},null,8,["modelValue","rules"])]),_:1}),e(c,{cols:"12"},{default:t(()=>[e(k,{label:i.value.status?"Habilitado":"Deshabilitado",modelValue:i.value.status,"onUpdate:modelValue":n[2]||(n[2]=p=>i.value.status=p),color:"blue-darken-4",inset:""},null,8,["label","modelValue"])]),_:1})]),_:1})]),_:1}),e(O,null,{default:t(()=>[e(_,{type:"button",variant:"text",color:"secondary",onClick:n[3]||(n[3]=p=>u.value=!1)},{default:t(()=>n[5]||(n[5]=[U(" Cancelar ")])),_:1}),e(S),e(_,{text:"Guardar",color:"primary",type:"submit",loading:a.value},null,8,["loading"])]),_:1})]),_:1},8,["title"])]),_:1},512)]),_:1},8,["modelValue"])}}}),Q=[{title:"Op.",key:"actions",value:"actions",fixed:!0,width:"50px",sortable:!1},{title:"Nombre",key:"name",value:"name"},{title:"Descripción",key:"description",value:"description"},{title:"Estado",key:"status",value:"status"}],W=P({__name:"DataTable",props:{options:{},items:{},loading:{type:Boolean},total:{}},emits:["onUpdateTable"],setup(m,{emit:l}){const d=l;return(r,a)=>{const u=o("v-icon"),i=o("v-list-item"),x=o("v-list"),f=o("v-menu"),n=o("v-btn"),V=o("v-data-table-server"),c=$("permission");return b(),g(V,{"items-per-page":r.options.itemsPerPage,"onUpdate:itemsPerPage":[a[1]||(a[1]=s=>r.options.itemsPerPage=s),a[4]||(a[4]=s=>d("onUpdateTable"))],"sort-by":r.options.sortBy,"onUpdate:sortBy":[a[2]||(a[2]=s=>r.options.sortBy=s),a[5]||(a[5]=s=>d("onUpdateTable"))],page:r.options.page,"onUpdate:page":[a[3]||(a[3]=s=>r.options.page=s),a[6]||(a[6]=s=>d("onUpdateTable"))],headers:w(Q),items:r.items,"items-length":r.total,loading:r.loading,"item-value":"id","multi-sort":""},{"item.actions":t(({item:s})=>[y((b(),g(n,{icon:"",density:"compact",variant:"text"},{default:t(()=>[e(u,null,{default:t(()=>a[7]||(a[7]=[U("mdi-dots-vertical")])),_:1}),e(f,{activator:"parent"},{default:t(()=>[e(x,{density:"compact"},{default:t(()=>[y((b(),g(i,{key:"edit",value:"edit",title:"Editar","append-icon":"mdi-pencil"},{default:t(()=>[e(w(N),{formState:s,onOnSuccess:a[0]||(a[0]=k=>d("onUpdateTable"))},null,8,["formState"])]),_:2},1024)),[[c,["offices.edit"]]]),y((b(),g(i,{key:"delete",value:"delete",title:"Eliminar",class:"text-red","append-icon":"mdi-delete"},{default:t(()=>[e(L,{title:"Eliminar",message:"¿Está seguro de eliminar este registro?",onOnConfirm:async()=>{await w(J)(s.id)&&d("onUpdateTable")}},null,8,["onOnConfirm"])]),_:2},1024)),[[c,["offices.delete"]]])]),_:2},1024)]),_:2},1024)]),_:2},1024)),[[c,["offices.edit","offices.delete"]]])]),"item.status":t(({item:s})=>[e(n,{color:s.status?"blue":"error","text-color":"white",density:"compact",variant:"tonal"},{default:t(()=>[U(H(s.status?"Habilitado":"Deshabilitado"),1)]),_:2},1032,["color"])]),_:1},8,["items-per-page","sort-by","page","headers","items","items-length","loading"])}}}),h=P({__name:"index",setup(m){const l=v(!1),d=v(!1),r=v([]),a=v(0),u=v({itemsPerPage:10,sortBy:[],page:1,search:"",filters:{}}),i=async()=>{d.value=!0;const f=await z(u.value);r.value=f.data,a.value=f.total,d.value=!1},x=async()=>{l.value=!0,await i(),l.value=!1};return x(),(f,n)=>{const V=o("v-text-field"),c=o("v-col"),s=o("v-btn"),k=o("v-row"),T=o("v-card-item"),D=o("v-card"),_=$("permission"),S=$("tooltip");return b(),g(D,{title:"Oficinas",subtitle:"Gestión de oficinas",disabled:l.value},{default:t(()=>[e(T,{class:"border-t border-b"},{default:t(()=>[e(k,{class:"d-flex justify-space-between"},{default:t(()=>[e(c,{cols:"12",md:"4"},{default:t(()=>[y(e(V,{modelValue:u.value.search,"onUpdate:modelValue":n[0]||(n[0]=O=>u.value.search=O),label:"Buscar",clearable:"",onInput:i},null,8,["modelValue"]),[[_,["offices.index"]]])]),_:1}),e(c,{cols:"12",md:"4",class:"d-md-flex d-block justify-end text-end"},{default:t(()=>[y((b(),g(s,{class:"h-md-auto me-2",disabled:l.value},{default:t(()=>[n[1]||(n[1]=U(" nuevo ")),e(w(N),{onOnSuccess:i})]),_:1},8,["disabled"])),[[_,["offices.create"]]]),y(e(s,{class:"h-md-auto",density:"comfortable",icon:"mdi-reload",onClick:x,loading:d.value},null,8,["loading"]),[[S,"Recargar registros"],[_,["offices.index"]]])]),_:1})]),_:1})]),_:1}),y(e(w(W),{options:u.value,loading:d.value,items:r.value,total:a.value,onOnUpdateTable:i},null,8,["options","loading","items","total"]),[[_,["offices.index"]]])]),_:1},8,["disabled"])}}});export{h as default};
